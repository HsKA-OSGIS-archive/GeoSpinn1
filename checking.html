<!DOCTYPE html>
<html>
  <head>
    <title>turf.js</title>
    <link rel="stylesheet" href="https://openlayers.org/en/v4.5.0/css/ol.css" type="text/css">
    <!-- The line below is only needed for old environments like Internet Explorer and Android 4.x -->
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,URL"></script>
    <script src="https://openlayers.org/en/v4.5.0/build/ol.js"></script>
<<<<<<< HEAD
   	<script src="/Users/keneuoe/Development/GeoSpinn1/GeoSpinn1-master/GeoSpinn1/turf_FriNov242017.js"></script>
	<script src="/Users/keneuoe/Development/GeoSpinn1/GeoSpinn1-master/GeoSpinn1/areas.js"></script>
=======
   	<script src="https://raw.githubusercontent.com/HsKA-OSGIS/GeoSpinn1/master/turf_FriNov242017.js"></script>
	<script src="https://raw.githubusercontent.com/HsKA-OSGIS/GeoSpinn1/master/areas.js"></script>
>>>>>>> 4a206b4913d5e549bbfad2bf59a3520213beb841
  </head>
  <body>
    <div id="map" class="map"></div>
    <script>
      // this example uses turf.js for which we don't have an externs file.
      var source = new ol.source.Vector();
	  var source2 = new ol.source.Vector();
	  var model_source = new ol.source.Vector();
	  var format = new ol.format.GeoJSON();
	 	   
	  var poly1 = {
    "type": "Feature",
    "properties": {
      "fill": "#0f0"
    },
    "geometry": {
      "type": "Polygon",
      "coordinates": [[
        [-122.801742, 45.48565],
        [-122.801742, 45.60491],
        [-122.584762, 45.60491],
        [-122.584762, 45.48565],
        [-122.801742, 45.48565]
      ]]
    }
  };
  var poly2 = {
    "type": "Feature",
    "properties": {
      "fill": "#00f"
    },
    "geometry": {
      "type": "Polygon",
      "coordinates": [[
        [-122.520217, 45.535693],
        [-122.64038, 45.553967],
        [-122.720031, 45.526554],
        [-122.669906, 45.507309],
        [-122.723464, 45.446643],
        [-122.532577, 45.408574],
        [-122.487258, 45.477466],
        [-122.520217, 45.535693]
      ]]
    }
 };
	  
var geojson = {
"type": "FeatureCollection",
"crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },
"features": [
{ "type": "Feature", "properties": { "NO": 0, "Name": "Aachen-Laurensberg", "latitude": 6.024, "longitude": 50.799, "elevation": 231, "date": "10\/12\/2015", "time": "0:00:00", "radiation": 0.094624486, "field_9": null, "0:00:00": "0:00:00", "field_11": null, "NO_1": 0, "Name_1": "Aachen-Laurensberg", "latitude_1": 6.024, "longitude_1": 50.799, "elevation_1": 231, "date_1": 42289, "time_1": 0, "radiation_1": 0.094624486 }, "geometry": { "type": "Point", "coordinates": [ 6.024, 50.799 ] } },
{ "type": "Feature", "properties": { "NO": 577, "Name": "Aalen-ST-Unterkochen", "latitude": 10.119, "longitude": 48.825, "elevation": 455, "date": "10\/12\/2015", "time": "0:00:00", "radiation": 0.067679099, "field_9": null, "0:00:00": "0:00:00", "field_11": null, "NO_1": 577, "Name_1": "Aalen-ST-Unterkochen", "latitude_1": 10.119, "longitude_1": 48.825, "elevation_1": 455, "date_1": 42289, "time_1": 0, "radiation_1": 0.067679099 }, "geometry": { "type": "Point", "coordinates": [ 10.119, 48.825 ] } },
{ "type": "Feature", "properties": { "NO": 1154, "Name": "Abenberg", "latitude": 10.975, "longitude": 49.239, "elevation": 385, "date": "10\/12\/2015", "time": "0:00:00", "radiation": 0.113954717, "field_9": null, "0:00:00": "0:00:00", "field_11": null, "NO_1": 1154, "Name_1": "Abenberg", "latitude_1": 10.975, "longitude_1": 49.239, "elevation_1": 385, "date_1": 42289, "time_1": 0, "radiation_1": 0.113954717 }, "geometry": { "type": "Point", "coordinates": [ 10.975, 49.239 ] } },
{ "type": "Feature", "properties": { "NO": 6924, "Name": "Ahlbeck", "latitude": 14.189, "longitude": 53.672, "elevation": 8, "date": "10\/12\/2015", "time": "0:00:00", "radiation": 0.066651625, "field_9": null, "0:00:00": "0:00:00", "field_11": null, "NO_1": 6924, "Name_1": "Ahlbeck", "latitude_1": 14.189, "longitude_1": 53.672, "elevation_1": 8, "date_1": 42289, "time_1": 0, "radiation_1": 0.066651625 }, "geometry": { "type": "Point", "coordinates": [ 14.189, 53.672 ] } }
]
};

var areas = areas;




var my_json = [
{
    "type": "buffer",
 "id"  : 1,
    "parameters" :{
  "l1": "poly1",
  "radius": 150,
  "units" : "kilometers"
 }
}, {
    "type": "union",
 "id"  : 2,
    "parameters" : {
  "l1": 1
 }
},
{
    "type": "intersect",
 "id"  : 3,
    "parameters" : {
  "l1": 2,
  "l2": "poly2"
 }
}

];   

	 
	  for (var feature in areas.features){
		//console.log(areas.features[feature]);
		var f = format.readFeature(areas.features[feature]);
		f.getGeometry().transform('EPSG:4326', 'EPSG:3857');
		source.addFeature(f);
	  }
	  
	  
	  for (var feature in geojson.features){
		//console.log(geojson.features[feature]);
		var f = format.readFeature(geojson.features[feature]);
		f.getGeometry().transform('EPSG:4326', 'EPSG:3857');
		source2.addFeature(f);
	  }
	  
	  var polygon1 = format.readFeature(poly1);
	  polygon1.getGeometry().transform('EPSG:4326', 'EPSG:3857');
	  
	  var polygon2 = format.readFeature(poly2);
	  polygon2.getGeometry().transform('EPSG:4326', 'EPSG:3857');
	  
	  //source.addFeature(int_result);
	  source.addFeature(polygon1);
	  source.addFeature(polygon2);
	  
	  
	  var model = turf.model(my_json , geojson, areas);
	  
	  
	  console.log(model);
	  var model_result = format.readFeatures(model, {
      dataProjection: 'EPSG:4326',
      featureProjection: 'EPSG:3857'
    });
<<<<<<< HEAD
	  //console.log(model_result);
	  //model_result.getGeometry().transform('EPSG:4326', 'EPSG:3857');
=======
	  console.log(model_result);
	 
>>>>>>> 4a206b4913d5e549bbfad2bf59a3520213beb841
	  model_source.addFeatures(model_result);
	  
      var areasLayer = new ol.layer.Vector({
        source: source,
		style : new ol.style.Style({
		    stroke: new ol.style.Stroke({
			color: 'black',
			width: 2
		    })
		})
		});
	
	var layer2 = new ol.layer.Vector({
        source: source2,
        style: new ol.style.Style({
			
			image: new ol.style.Circle({
                    radius: 5,
					stroke: new ol.style.Stroke({
						color: 'black',
						width: 2
					  }),
                    fill: new ol.style.Fill({
                        color: 'orange'
                    })
             })
        })
		});
	
	var modelLayer = new ol.layer.Vector({
        source: model_source,
		style : new ol.style.Style({
		    stroke: new ol.style.Stroke({
			color: 'cyan',
			width: 1
		    }),
		    fill: new ol.style.Fill({
			 color: "blue"
		    })
		})
		});
	  	
		
      var rasterLayer = new ol.layer.Tile({
        source: new ol.source.OSM()
      });

      var map = new ol.Map({
        layers: [rasterLayer, areasLayer, modelLayer,layer2],
        target: document.getElementById('map'),
        view: new ol.View({
          center: ol.proj.fromLonLat([10.119, 48.825]),
          zoom: 8
        })
      });
    </script>
  </body>
</html>
